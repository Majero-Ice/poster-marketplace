# Project Rules

## Communication
- Always respond in English, regardless of the language of the prompt
- Be concise and direct
- Do not write comments in code unless explicitly asked

## Code Style
- Write clean, readable, self-documenting code
- Use meaningful variable and function names
- Prefer explicit over implicit
- Keep functions small and single-purpose
- Write code that is easy to extend and maintain
- Handle errors explicitly, never silently fail

## Tech Stack
- Next.js 14+ with App Router
- TypeScript (strict mode)
- Tailwind CSS
- shadcn/ui components
- Prisma ORM
- Supabase (PostgreSQL + Storage)
- Stripe for payments

## Architecture: Feature-Sliced Design (FSD)

Follow this structure:
```
src/
├── app/                    # Next.js App Router (pages + API routes)
├── widgets/                # Composite UI blocks (header, footer, grids)
├── features/               # User interactions (purchase, download)
├── entities/               # Business entities (poster, purchase)
└── shared/                 # Reusable infrastructure
    ├── ui/                 # shadcn components
    ├── lib/                # utilities, prisma, stripe
    ├── api/                # fetch helpers
    └── config/             # env, constants
```

### FSD Rules
- Each slice contains: ui/, model/, api/, lib/ as needed
- Lower layers cannot import from upper layers
- Import order: shared → entities → features → widgets → app
- Public API through index.ts exports
- No cross-imports between slices on same layer

### Layer Responsibilities
- **app/**: Only routing and page composition, minimal logic
- **widgets/**: Complex UI assembled from entities and features
- **features/**: User actions with business logic
- **entities/**: Data types, API calls, basic UI for domain objects
- **shared/**: Framework-agnostic utilities and UI primitives

## React Patterns
- Functional components with hooks
- Prefer composition over inheritance
- Extract reusable logic into custom hooks
- Use Server Components by default
- Add "use client" only when needed (interactivity, hooks)
- Colocate component + types + styles

## Next.js Specifics
- Use App Router conventions
- Server Components for data fetching
- API routes in app/api/ for backend logic
- Use Next.js Image component for images
- Metadata API for SEO

## Styling
- Tailwind utility classes
- Use cn() helper for conditional classes
- Mobile-first responsive design
- Extract repeated patterns into components, not CSS

## Database (Prisma)
- Schema in prisma/schema.prisma
- Use migrations for changes
- Prisma client in shared/lib/prisma.ts
- Never expose raw queries to client

## Stripe
- Test mode during development
- Stripe client in shared/lib/stripe.ts
- Webhook signature verification required
- Handle events idempotently

## File Organization
- One component per file
- Name files after the component/function
- Group related files in folders
- Use barrel exports (index.ts)

## Git
- Clear commit messages
- Small, focused commits
- One logical change per commit

## Tailwind
- Use only standard Tailwind classes, no custom utilities unless defined in config
- Check Tailwind v4.1 documentation when unsure
- Prefer spacing scale: p-4, m-2, gap-4 (not arbitrary values like p-[17px])
- Use responsive prefixes: sm:, md:, lg:, xl:
- Use state prefixes: hover:, focus:, active:, disabled: